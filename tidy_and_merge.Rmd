---
title: "Merge"
author: "Taehoon Ha"
date: "09/23/2018"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(tidyverse)
```

### 4. Download two files:
  * **coverage.csv** - Health Insurance Coverage of the Total Population (2013 - 2016)
  * **expenditures.csv** - Health Care Expenditures by State of Residence (in millions)
```{r}
coverage <- read.csv('coverage.csv', skip = 2, nrows = 52, header = T, sep = ',', stringsAsFactors = F)
expenditures <- read.csv('expenditures.csv', skip = 2, nrows = 52, header = T, sep = ',', stringsAsFactors = F)
```

  4.1 Make the data frames "tidy."
```{r}
tidy.coverage <- coverage %>% 
  gather(key = XYear__Category, value = Cases, indexes = 2:ncol(coverage)) %>%
  separate(XYear__Category, into = c("XYear", "Category"), sep = '__') %>%
  mutate(Year = gsub("X","", XYear)) %>%
  select(-XYear)

tidy.expenditures <- expenditures %>% 
  gather(XYear__Category, value = Total.Amount, indexes = 2:ncol(expenditures)) %>%
  separate(XYear__Category, into = c("XYear", "Category"), sep = '__') %>%
  mutate(Year = gsub("X","", XYear)) %>%
  select(-XYear)

tidy.coverage
tidy.expenditures
```

  4.2 Merge two data frames: the resulting data frame should contain information about coverage and expenditures for years 2013-2016. Please note that file **expenditures.csv** does not contain years 2015-2016.
```{r}
merge(tidy.coverage, tidy.expenditures, by = c("Location", "Year"), all = T) %>%
  filter(Year >= 2013 & Year <= 2016)
```

### 5. Submit a link to the repo “Lab2” via Canvas.
  